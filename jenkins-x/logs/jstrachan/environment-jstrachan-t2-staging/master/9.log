Step: build-step-credential-initializer-vkhnh:

{"level":"warn","ts":1551378725.3966858,"logger":"fallback-logger","caller":"logging/config.go:65","msg":"Fetch GitHub commit ID from kodata failed: \"ref: refs/heads/test\" is not a valid GitHub commit ID"}
{"level":"info","ts":1551378725.3987103,"logger":"fallback-logger","caller":"creds-init/main.go:40","msg":"Credentials initialized."}
Step: build-step-git-source-jstrachan-environment-jstrachan-t2-stagin:

{"level":"warn","ts":1551378726.612676,"logger":"fallback-logger","caller":"logging/config.go:65","msg":"Fetch GitHub commit ID from kodata failed: \"ref: refs/heads/test\" is not a valid GitHub commit ID"}
{"level":"info","ts":1551378728.0798466,"logger":"fallback-logger","caller":"git-init/main.go:90","msg":"Successfully cloned \"https://github.com/jstrachan/environment-jstrachan-t2-staging\" @ \"v0.0.9\" in path \"/workspace/source\""}
Step: build-step-place-tools:

Step: build-step-setup-jx-git-credentials:

Generated Git credentials file /home/jenkins/git/credentials
Step: build-step-build-helm-apply:

Modified file /workspace/source/env/Chart.yaml to set the chart to version 9
No $CHART_REPOSITORY defined so using the default value of: http://jenkins-x-chartmuseum:8080
Adding missing Helm repo: jenkins-x http://chartmuseum.jenkins-x.io
Successfully added Helm repository jenkins-x.
Adding missing Helm repo: releases http://jenkins-x-chartmuseum:8080
Successfully added Helm repository releases.
No --namespace option specified or $DEPLOY_NAMESPACE environment variable available so defaulting to using namespace jx
Applying helm chart at . as release name jx to namespace jx
Ignoring templates/.gitignore
Wrote chart values.yaml values.yaml generated from directory tree
Using values files: values.yaml
Applying generated chart . YAML via kubectl in dir: /tmp/helm-template-workdir-285219988/jx/output
serviceaccount/cleanup configured
deployment.extensions/jx-demo261 created
release.jenkins.io/demo261-0.0.1 configured
configmap/exposecontroller configured
serviceaccount/expose configured
Error from server (Forbidden): error when applying patch:
{"metadata":{"annotations":{"jenkins.io/chart":"env","kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rbac.authorization.k8s.io/v1\",\"kind\":\"Role\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"env\"},\"labels\":{\"jenkins.io/chart-release\":\"jx\",\"jenkins.io/version\":\"9\"},\"name\":\"cleanup\",\"namespace\":\"jx\"},\"rules\":[{\"apiGroups\":[\"extensions\"],\"resources\":[\"ingresses\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"create\",\"update\",\"delete\"]},{\"apiGroups\":[\"\"],\"resources\":[\"configmaps\",\"services\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"update\"]},{\"apiGroups\":[\"extensions\",\"apps\"],\"resources\":[\"deployments\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"update\"]},{\"apiGroups\":[\"\",\"route.openshift.io\"],\"resources\":[\"routes\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"create\",\"update\",\"delete\"]}]}\n"},"labels":{"jenkins.io/chart-release":"jx","jenkins.io/version":"9"}}}
to:
Resource: "rbac.authorization.k8s.io/v1, Resource=roles", GroupVersionKind: "rbac.authorization.k8s.io/v1, Kind=Role"
Name: "cleanup", Namespace: "jx"
Object: &{map["kind":"Role" "apiVersion":"rbac.authorization.k8s.io/v1" "metadata":map["annotations":map["jenkins.io/chart":"jx-app-jenkins" "kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rbac.authorization.k8s.io/v1\",\"kind\":\"Role\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"jx-app-jenkins\"},\"labels\":{\"jenkins.io/chart-release\":\"jx-app-jenkins\",\"jenkins.io/version\":\"0.0.5\"},\"name\":\"cleanup\",\"namespace\":\"jx\"},\"rules\":[{\"apiGroups\":[\"extensions\"],\"resources\":[\"ingresses\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"create\",\"update\",\"delete\"]},{\"apiGroups\":[\"\"],\"resources\":[\"configmaps\",\"services\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"update\"]},{\"apiGroups\":[\"extensions\",\"apps\"],\"resources\":[\"deployments\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"update\"]},{\"apiGroups\":[\"\",\"route.openshift.io\"],\"resources\":[\"routes\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"create\",\"update\",\"delete\"]}]}\n"] "name":"cleanup" "namespace":"jx" "selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/jx/roles/cleanup" "uid":"5830d67f-3b57-11e9-b378-42010a840126" "resourceVersion":"8463" "creationTimestamp":"2019-02-28T12:49:53Z" "labels":map["jenkins.io/version":"0.0.5" "jenkins.io/chart-release":"jx-app-jenkins"]] "rules":[map["verbs":["get" "list" "watch" "patch" "create" "update" "delete"] "apiGroups":["extensions"] "resources":["ingresses"]] map["resources":["configmaps" "services"] "verbs":["get" "list" "watch" "patch" "update"] "apiGroups":[""]] map["verbs":["get" "list" "watch" "patch" "update"] "apiGroups":["extensions" "apps"] "resources":["deployments"]] map["verbs":["get" "list" "watch" "patch" "create" "update" "delete"] "apiGroups":["" "route.openshift.io"] "resources":["routes"]]]]}
for: "/tmp/helm-template-workdir-285219988/jx/output/env/charts/cleanup/templates/role.yaml": roles.rbac.authorization.k8s.io "cleanup" is forbidden: attempt to grant extra privileges: [{[patch] [extensions] [ingresses] [] []} {[update] [extensions] [ingresses] [] []} {[delete] [extensions] [ingresses] [] []} {[update] [] [configmaps] [] []} {[patch] [] [services] [] []} {[update] [] [services] [] []} {[patch] [extensions] [deployments] [] []} {[update] [extensions] [deployments] [] []} {[get] [apps] [deployments] [] []} {[list] [apps] [deployments] [] []} {[watch] [apps] [deployments] [] []} {[patch] [apps] [deployments] [] []} {[update] [apps] [deployments] [] []} {[get] [] [routes] [] []} {[list] [] [routes] [] []} {[watch] [] [routes] [] []} {[patch] [] [routes] [] []} {[create] [] [routes] [] []} {[update] [] [routes] [] []} {[delete] [] [routes] [] []} {[get] [route.openshift.io] [routes] [] []} {[list] [route.openshift.io] [routes] [] []} {[watch] [route.openshift.io] [routes] [] []} {[patch] [route.openshift.io] [routes] [] []} {[create] [route.openshift.io] [routes] [] []} {[update] [route.openshift.io] [routes] [] []} {[delete] [route.openshift.io] [routes] [] []}] user=&{system:serviceaccount:jx:tekton-bot 44d58eff-3b57-11e9-b378-42010a840126 [system:serviceaccounts system:serviceaccounts:jx system:authenticated] map[]} ownerrules=[{[create] [authorization.k8s.io] [selfsubjectaccessreviews selfsubjectrulesreviews] [] []} {[get] [] [] [] [/api /api/* /apis /apis/* /healthz /openapi /openapi/* /swagger-2.0.0.pb-v1 /swagger.json /swaggerapi /swaggerapi/* /version /version/]} {[list create get update] [apiextensions.k8s.io] [customresourcedefinitions] [] []} {[create get] [] [namespaces] [] []} {[get list watch] [extensions] [ingresses] [] []} {[get] [] [services] [] []} {[list get watch] [] [secrets services] [] []} {[list get watch patch] [] [serviceaccounts configmaps] [] []} {[create get delete] [] [pods services] [] []} {[create] [] [pods/exec] [] []} {[get create update] [jenkins.io] [pipelineactivities sourcerepositories] [] []} {[get list watch] [jenkins.io] [plugins] [] []} {[create update get list watch] [jenkins.io] [users] [] []} {[get create list watch patch] [jenkins.io] [releases] [] []} {[get list] [] [namespaces] [] []} {[get list watch create] [extensions] [ingresses deployments] [] []} {[get create update] [jenkins.io] [pipelineactivities] [] []} {[create list get update] [jenkins.io] [environments] [] []} {[get list] [jenkins.io] [extensions] [] []} {[get list watch] [vault.banzaicloud.com] [vaults] [] []} {[get patch] [rbac.authorization.k8s.io] [rolebindings roles] [] []}] ruleResolutionErrors=[]
Error from server (Forbidden): error when applying patch:
{"metadata":{"annotations":{"jenkins.io/chart":"env","kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rbac.authorization.k8s.io/v1\",\"kind\":\"RoleBinding\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"env\"},\"labels\":{\"jenkins.io/chart-release\":\"jx\",\"jenkins.io/version\":\"9\"},\"name\":\"cleanup\",\"namespace\":\"jx\"},\"roleRef\":{\"apiGroup\":\"rbac.authorization.k8s.io\",\"kind\":\"Role\",\"name\":\"cleanup\"},\"subjects\":[{\"kind\":\"ServiceAccount\",\"name\":\"cleanup\",\"namespace\":\"jx\"}]}\n"},"labels":{"jenkins.io/chart-release":"jx","jenkins.io/version":"9"}}}
to:
Resource: "rbac.authorization.k8s.io/v1, Resource=rolebindings", GroupVersionKind: "rbac.authorization.k8s.io/v1, Kind=RoleBinding"
Name: "cleanup", Namespace: "jx"
Object: &{map["kind":"RoleBinding" "apiVersion":"rbac.authorization.k8s.io/v1" "metadata":map["name":"cleanup" "namespace":"jx" "selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/jx/rolebindings/cleanup" "uid":"5846ab8b-3b57-11e9-b378-42010a840126" "resourceVersion":"8466" "creationTimestamp":"2019-02-28T12:49:54Z" "labels":map["jenkins.io/chart-release":"jx-app-jenkins" "jenkins.io/version":"0.0.5"] "annotations":map["jenkins.io/chart":"jx-app-jenkins" "kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rbac.authorization.k8s.io/v1\",\"kind\":\"RoleBinding\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"jx-app-jenkins\"},\"labels\":{\"jenkins.io/chart-release\":\"jx-app-jenkins\",\"jenkins.io/version\":\"0.0.5\"},\"name\":\"cleanup\",\"namespace\":\"jx\"},\"roleRef\":{\"apiGroup\":\"rbac.authorization.k8s.io\",\"kind\":\"Role\",\"name\":\"cleanup\"},\"subjects\":[{\"kind\":\"ServiceAccount\",\"name\":\"cleanup\",\"namespace\":\"jx\"}]}\n"]] "subjects":[map["kind":"ServiceAccount" "name":"cleanup" "namespace":"jx"]] "roleRef":map["apiGroup":"rbac.authorization.k8s.io" "kind":"Role" "name":"cleanup"]]}
for: "/tmp/helm-template-workdir-285219988/jx/output/env/charts/cleanup/templates/rolebinding.yaml": rolebindings.rbac.authorization.k8s.io "cleanup" is forbidden: attempt to grant extra privileges: [{[patch] [extensions] [ingresses] [] []} {[update] [extensions] [ingresses] [] []} {[delete] [extensions] [ingresses] [] []} {[update] [] [configmaps] [] []} {[patch] [] [services] [] []} {[update] [] [services] [] []} {[patch] [extensions] [deployments] [] []} {[update] [extensions] [deployments] [] []} {[get] [apps] [deployments] [] []} {[list] [apps] [deployments] [] []} {[watch] [apps] [deployments] [] []} {[patch] [apps] [deployments] [] []} {[update] [apps] [deployments] [] []} {[get] [] [routes] [] []} {[list] [] [routes] [] []} {[watch] [] [routes] [] []} {[patch] [] [routes] [] []} {[create] [] [routes] [] []} {[update] [] [routes] [] []} {[delete] [] [routes] [] []} {[get] [route.openshift.io] [routes] [] []} {[list] [route.openshift.io] [routes] [] []} {[watch] [route.openshift.io] [routes] [] []} {[patch] [route.openshift.io] [routes] [] []} {[create] [route.openshift.io] [routes] [] []} {[update] [route.openshift.io] [routes] [] []} {[delete] [route.openshift.io] [routes] [] []}] user=&{system:serviceaccount:jx:tekton-bot 44d58eff-3b57-11e9-b378-42010a840126 [system:serviceaccounts system:serviceaccounts:jx system:authenticated] map[]} ownerrules=[{[create] [authorization.k8s.io] [selfsubjectaccessreviews selfsubjectrulesreviews] [] []} {[get] [] [] [] [/api /api/* /apis /apis/* /healthz /openapi /openapi/* /swagger-2.0.0.pb-v1 /swagger.json /swaggerapi /swaggerapi/* /version /version/]} {[list create get update] [apiextensions.k8s.io] [customresourcedefinitions] [] []} {[create get] [] [namespaces] [] []} {[get list watch] [extensions] [ingresses] [] []} {[get] [] [services] [] []} {[list get watch] [] [secrets services] [] []} {[list get watch patch] [] [serviceaccounts configmaps] [] []} {[create get delete] [] [pods services] [] []} {[create] [] [pods/exec] [] []} {[get create update] [jenkins.io] [pipelineactivities sourcerepositories] [] []} {[get list watch] [jenkins.io] [plugins] [] []} {[create update get list watch] [jenkins.io] [users] [] []} {[get create list watch patch] [jenkins.io] [releases] [] []} {[get list] [] [namespaces] [] []} {[get list watch create] [extensions] [ingresses deployments] [] []} {[get create update] [jenkins.io] [pipelineactivities] [] []} {[create list get update] [jenkins.io] [environments] [] []} {[get list] [jenkins.io] [extensions] [] []} {[get list watch] [vault.banzaicloud.com] [vaults] [] []} {[get patch] [rbac.authorization.k8s.io] [rolebindings roles] [] []}] ruleResolutionErrors=[]
Error from server (Forbidden): error when applying patch:
{"metadata":{"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"Service\",\"metadata\":{\"annotations\":{\"fabric8.io/expose\":\"true\",\"fabric8.io/ingress.annotations\":\"kubernetes.io/ingress.class: nginx\",\"jenkins.io/chart\":\"env\"},\"labels\":{\"chart\":\"demo261-0.0.1\",\"jenkins.io/chart-release\":\"jx\",\"jenkins.io/version\":\"9\"},\"name\":\"demo261\",\"namespace\":\"jx\"},\"spec\":{\"ports\":[{\"name\":\"http\",\"port\":80,\"protocol\":\"TCP\",\"targetPort\":8080}],\"selector\":{\"app\":\"jx-demo261\"},\"type\":\"ClusterIP\"}}\n"},"labels":{"jenkins.io/version":"9"}}}
to:
Resource: "/v1, Resource=services", GroupVersionKind: "/v1, Kind=Service"
Name: "demo261", Namespace: "jx"
Object: &{map["kind":"Service" "apiVersion":"v1" "metadata":map["creationTimestamp":"2019-02-28T18:29:15Z" "labels":map["jenkins.io/version":"8" "chart":"demo261-0.0.1" "jenkins.io/chart-release":"jx"] "annotations":map["jenkins.io/chart":"env" "kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"Service\",\"metadata\":{\"annotations\":{\"fabric8.io/expose\":\"true\",\"fabric8.io/ingress.annotations\":\"kubernetes.io/ingress.class: nginx\",\"jenkins.io/chart\":\"env\"},\"labels\":{\"chart\":\"demo261-0.0.1\",\"jenkins.io/chart-release\":\"jx\",\"jenkins.io/version\":\"8\"},\"name\":\"demo261\",\"namespace\":\"jx\"},\"spec\":{\"ports\":[{\"name\":\"http\",\"port\":80,\"protocol\":\"TCP\",\"targetPort\":8080}],\"selector\":{\"app\":\"jx-demo261\"},\"type\":\"ClusterIP\"}}\n" "fabric8.io/expose":"true" "fabric8.io/ingress.annotations":"kubernetes.io/ingress.class: nginx"] "name":"demo261" "namespace":"jx" "selfLink":"/api/v1/namespaces/jx/services/demo261" "uid":"c08c5453-3b86-11e9-b378-42010a840126" "resourceVersion":"67499"] "spec":map["ports":[map["name":"http" "protocol":"TCP" "port":'P' "targetPort":'\u1f90']] "selector":map["app":"jx-demo261"] "clusterIP":"10.59.240.238" "type":"ClusterIP" "sessionAffinity":"None"] "status":map["loadBalancer":map[]]]}
for: "/tmp/helm-template-workdir-285219988/jx/output/env/charts/demo261/templates/service.yaml": services "demo261" is forbidden: User "system:serviceaccount:jx:tekton-bot" cannot patch services in the namespace "jx"
Error from server (Forbidden): error when applying patch:
{"metadata":{"annotations":{"jenkins.io/chart":"env","kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rbac.authorization.k8s.io/v1\",\"kind\":\"Role\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"env\"},\"labels\":{\"jenkins.io/chart-release\":\"jx\",\"jenkins.io/version\":\"9\"},\"name\":\"expose\",\"namespace\":\"jx\"},\"rules\":[{\"apiGroups\":[\"extensions\"],\"resources\":[\"ingresses\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"create\",\"update\",\"delete\"]},{\"apiGroups\":[\"\"],\"resources\":[\"configmaps\",\"services\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"update\"]},{\"apiGroups\":[\"extensions\",\"apps\"],\"resources\":[\"deployments\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"update\"]},{\"apiGroups\":[\"\",\"route.openshift.io\"],\"resources\":[\"routes\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"create\",\"update\",\"delete\"]}]}\n"},"labels":{"jenkins.io/chart-release":"jx","jenkins.io/version":"9"}}}
to:
Resource: "rbac.authorization.k8s.io/v1, Resource=roles", GroupVersionKind: "rbac.authorization.k8s.io/v1, Kind=Role"
Name: "expose", Namespace: "jx"
Object: &{map["kind":"Role" "apiVersion":"rbac.authorization.k8s.io/v1" "metadata":map["annotations":map["jenkins.io/chart":"jx-app-jenkins" "kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rbac.authorization.k8s.io/v1\",\"kind\":\"Role\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"jx-app-jenkins\"},\"labels\":{\"jenkins.io/chart-release\":\"jx-app-jenkins\",\"jenkins.io/version\":\"0.0.5\"},\"name\":\"expose\",\"namespace\":\"jx\"},\"rules\":[{\"apiGroups\":[\"extensions\"],\"resources\":[\"ingresses\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"create\",\"update\",\"delete\"]},{\"apiGroups\":[\"\"],\"resources\":[\"configmaps\",\"services\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"update\"]},{\"apiGroups\":[\"extensions\",\"apps\"],\"resources\":[\"deployments\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"update\"]},{\"apiGroups\":[\"\",\"route.openshift.io\"],\"resources\":[\"routes\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"create\",\"update\",\"delete\"]}]}\n"] "name":"expose" "namespace":"jx" "selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/jx/roles/expose" "uid":"5ba460d2-3b57-11e9-b378-42010a840126" "resourceVersion":"8468" "creationTimestamp":"2019-02-28T12:49:59Z" "labels":map["jenkins.io/chart-release":"jx-app-jenkins" "jenkins.io/version":"0.0.5"]] "rules":[map["verbs":["get" "list" "watch" "patch" "create" "update" "delete"] "apiGroups":["extensions"] "resources":["ingresses"]] map["verbs":["get" "list" "watch" "patch" "update"] "apiGroups":[""] "resources":["configmaps" "services"]] map["verbs":["get" "list" "watch" "patch" "update"] "apiGroups":["extensions" "apps"] "resources":["deployments"]] map["verbs":["get" "list" "watch" "patch" "create" "update" "delete"] "apiGroups":["" "route.openshift.io"] "resources":["routes"]]]]}
for: "/tmp/helm-template-workdir-285219988/jx/output/env/charts/expose/templates/role.yaml": roles.rbac.authorization.k8s.io "expose" is forbidden: attempt to grant extra privileges: [{[patch] [extensions] [ingresses] [] []} {[update] [extensions] [ingresses] [] []} {[delete] [extensions] [ingresses] [] []} {[update] [] [configmaps] [] []} {[patch] [] [services] [] []} {[update] [] [services] [] []} {[patch] [extensions] [deployments] [] []} {[update] [extensions] [deployments] [] []} {[get] [apps] [deployments] [] []} {[list] [apps] [deployments] [] []} {[watch] [apps] [deployments] [] []} {[patch] [apps] [deployments] [] []} {[update] [apps] [deployments] [] []} {[get] [] [routes] [] []} {[list] [] [routes] [] []} {[watch] [] [routes] [] []} {[patch] [] [routes] [] []} {[create] [] [routes] [] []} {[update] [] [routes] [] []} {[delete] [] [routes] [] []} {[get] [route.openshift.io] [routes] [] []} {[list] [route.openshift.io] [routes] [] []} {[watch] [route.openshift.io] [routes] [] []} {[patch] [route.openshift.io] [routes] [] []} {[create] [route.openshift.io] [routes] [] []} {[update] [route.openshift.io] [routes] [] []} {[delete] [route.openshift.io] [routes] [] []}] user=&{system:serviceaccount:jx:tekton-bot 44d58eff-3b57-11e9-b378-42010a840126 [system:serviceaccounts system:serviceaccounts:jx system:authenticated] map[]} ownerrules=[{[create] [authorization.k8s.io] [selfsubjectaccessreviews selfsubjectrulesreviews] [] []} {[get] [] [] [] [/api /api/* /apis /apis/* /healthz /openapi /openapi/* /swagger-2.0.0.pb-v1 /swagger.json /swaggerapi /swaggerapi/* /version /version/]} {[list create get update] [apiextensions.k8s.io] [customresourcedefinitions] [] []} {[create get] [] [namespaces] [] []} {[get list watch] [extensions] [ingresses] [] []} {[get] [] [services] [] []} {[list get watch] [] [secrets services] [] []} {[list get watch patch] [] [serviceaccounts configmaps] [] []} {[create get delete] [] [pods services] [] []} {[create] [] [pods/exec] [] []} {[get create update] [jenkins.io] [pipelineactivities sourcerepositories] [] []} {[get list watch] [jenkins.io] [plugins] [] []} {[create update get list watch] [jenkins.io] [users] [] []} {[get create list watch patch] [jenkins.io] [releases] [] []} {[get list] [] [namespaces] [] []} {[get list watch create] [extensions] [ingresses deployments] [] []} {[get create update] [jenkins.io] [pipelineactivities] [] []} {[create list get update] [jenkins.io] [environments] [] []} {[get list] [jenkins.io] [extensions] [] []} {[get list watch] [vault.banzaicloud.com] [vaults] [] []} {[get patch] [rbac.authorization.k8s.io] [rolebindings roles] [] []}] ruleResolutionErrors=[]
Error from server (Forbidden): error when applying patch:
{"metadata":{"annotations":{"jenkins.io/chart":"env","kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rbac.authorization.k8s.io/v1\",\"kind\":\"RoleBinding\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"env\"},\"labels\":{\"jenkins.io/chart-release\":\"jx\",\"jenkins.io/version\":\"9\"},\"name\":\"expose\",\"namespace\":\"jx\"},\"roleRef\":{\"apiGroup\":\"rbac.authorization.k8s.io\",\"kind\":\"Role\",\"name\":\"expose\"},\"subjects\":[{\"kind\":\"ServiceAccount\",\"name\":\"expose\",\"namespace\":\"jx\"}]}\n"},"labels":{"jenkins.io/chart-release":"jx","jenkins.io/version":"9"}}}
to:
Resource: "rbac.authorization.k8s.io/v1, Resource=rolebindings", GroupVersionKind: "rbac.authorization.k8s.io/v1, Kind=RoleBinding"
Name: "expose", Namespace: "jx"
Object: &{map["kind":"RoleBinding" "apiVersion":"rbac.authorization.k8s.io/v1" "metadata":map["creationTimestamp":"2019-02-28T12:49:59Z" "labels":map["jenkins.io/chart-release":"jx-app-jenkins" "jenkins.io/version":"0.0.5"] "annotations":map["jenkins.io/chart":"jx-app-jenkins" "kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rbac.authorization.k8s.io/v1\",\"kind\":\"RoleBinding\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"jx-app-jenkins\"},\"labels\":{\"jenkins.io/chart-release\":\"jx-app-jenkins\",\"jenkins.io/version\":\"0.0.5\"},\"name\":\"expose\",\"namespace\":\"jx\"},\"roleRef\":{\"apiGroup\":\"rbac.authorization.k8s.io\",\"kind\":\"Role\",\"name\":\"expose\"},\"subjects\":[{\"kind\":\"ServiceAccount\",\"name\":\"expose\",\"namespace\":\"jx\"}]}\n"] "name":"expose" "namespace":"jx" "selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/jx/rolebindings/expose" "uid":"5bb9a39b-3b57-11e9-b378-42010a840126" "resourceVersion":"8469"] "subjects":[map["kind":"ServiceAccount" "name":"expose" "namespace":"jx"]] "roleRef":map["name":"expose" "apiGroup":"rbac.authorization.k8s.io" "kind":"Role"]]}
for: "/tmp/helm-template-workdir-285219988/jx/output/env/charts/expose/templates/rolebinding.yaml": rolebindings.rbac.authorization.k8s.io "expose" is forbidden: attempt to grant extra privileges: [{[patch] [extensions] [ingresses] [] []} {[update] [extensions] [ingresses] [] []} {[delete] [extensions] [ingresses] [] []} {[update] [] [configmaps] [] []} {[patch] [] [services] [] []} {[update] [] [services] [] []} {[patch] [extensions] [deployments] [] []} {[update] [extensions] [deployments] [] []} {[get] [apps] [deployments] [] []} {[list] [apps] [deployments] [] []} {[watch] [apps] [deployments] [] []} {[patch] [apps] [deployments] [] []} {[update] [apps] [deployments] [] []} {[get] [] [routes] [] []} {[list] [] [routes] [] []} {[watch] [] [routes] [] []} {[patch] [] [routes] [] []} {[create] [] [routes] [] []} {[update] [] [routes] [] []} {[delete] [] [routes] [] []} {[get] [route.openshift.io] [routes] [] []} {[list] [route.openshift.io] [routes] [] []} {[watch] [route.openshift.io] [routes] [] []} {[patch] [route.openshift.io] [routes] [] []} {[create] [route.openshift.io] [routes] [] []} {[update] [route.openshift.io] [routes] [] []} {[delete] [route.openshift.io] [routes] [] []}] user=&{system:serviceaccount:jx:tekton-bot 44d58eff-3b57-11e9-b378-42010a840126 [system:serviceaccounts system:serviceaccounts:jx system:authenticated] map[]} ownerrules=[{[create] [authorization.k8s.io] [selfsubjectaccessreviews selfsubjectrulesreviews] [] []} {[get] [] [] [] [/api /api/* /apis /apis/* /healthz /openapi /openapi/* /swagger-2.0.0.pb-v1 /swagger.json /swaggerapi /swaggerapi/* /version /version/]} {[list create get update] [apiextensions.k8s.io] [customresourcedefinitions] [] []} {[create get] [] [namespaces] [] []} {[get list watch] [extensions] [ingresses] [] []} {[get] [] [services] [] []} {[list get watch] [] [secrets services] [] []} {[list get watch patch] [] [serviceaccounts configmaps] [] []} {[create get delete] [] [pods services] [] []} {[create] [] [pods/exec] [] []} {[get create update] [jenkins.io] [pipelineactivities sourcerepositories] [] []} {[get list watch] [jenkins.io] [plugins] [] []} {[create update get list watch] [jenkins.io] [users] [] []} {[get create list watch patch] [jenkins.io] [releases] [] []} {[get list] [] [namespaces] [] []} {[get list watch create] [extensions] [ingresses deployments] [] []} {[get create update] [jenkins.io] [pipelineactivities] [] []} {[create list get update] [jenkins.io] [environments] [] []} {[get list] [jenkins.io] [extensions] [] []} {[get list watch] [vault.banzaicloud.com] [vaults] [] []} {[get patch] [rbac.authorization.k8s.io] [rolebindings roles] [] []}] ruleResolutionErrors=[]
error: upgrading helm chart '.': failed to run 'kubectl apply --recursive -f /tmp/helm-template-workdir-285219988/jx/output -l jenkins.io/chart-release=jx --namespace jx --wait --validate=false' command in directory '', output: 'serviceaccount/cleanup configured
deployment.extensions/jx-demo261 created
release.jenkins.io/demo261-0.0.1 configured
configmap/exposecontroller configured
serviceaccount/expose configured
Error from server (Forbidden): error when applying patch:
{"metadata":{"annotations":{"jenkins.io/chart":"env","kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rbac.authorization.k8s.io/v1\",\"kind\":\"Role\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"env\"},\"labels\":{\"jenkins.io/chart-release\":\"jx\",\"jenkins.io/version\":\"9\"},\"name\":\"cleanup\",\"namespace\":\"jx\"},\"rules\":[{\"apiGroups\":[\"extensions\"],\"resources\":[\"ingresses\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"create\",\"update\",\"delete\"]},{\"apiGroups\":[\"\"],\"resources\":[\"configmaps\",\"services\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"update\"]},{\"apiGroups\":[\"extensions\",\"apps\"],\"resources\":[\"deployments\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"update\"]},{\"apiGroups\":[\"\",\"route.openshift.io\"],\"resources\":[\"routes\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"create\",\"update\",\"delete\"]}]}\n"},"labels":{"jenkins.io/chart-release":"jx","jenkins.io/version":"9"}}}
to:
Resource: "rbac.authorization.k8s.io/v1, Resource=roles", GroupVersionKind: "rbac.authorization.k8s.io/v1, Kind=Role"
Name: "cleanup", Namespace: "jx"
Object: &{map["kind":"Role" "apiVersion":"rbac.authorization.k8s.io/v1" "metadata":map["annotations":map["jenkins.io/chart":"jx-app-jenkins" "kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rbac.authorization.k8s.io/v1\",\"kind\":\"Role\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"jx-app-jenkins\"},\"labels\":{\"jenkins.io/chart-release\":\"jx-app-jenkins\",\"jenkins.io/version\":\"0.0.5\"},\"name\":\"cleanup\",\"namespace\":\"jx\"},\"rules\":[{\"apiGroups\":[\"extensions\"],\"resources\":[\"ingresses\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"create\",\"update\",\"delete\"]},{\"apiGroups\":[\"\"],\"resources\":[\"configmaps\",\"services\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"update\"]},{\"apiGroups\":[\"extensions\",\"apps\"],\"resources\":[\"deployments\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"update\"]},{\"apiGroups\":[\"\",\"route.openshift.io\"],\"resources\":[\"routes\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"create\",\"update\",\"delete\"]}]}\n"] "name":"cleanup" "namespace":"jx" "selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/jx/roles/cleanup" "uid":"5830d67f-3b57-11e9-b378-42010a840126" "resourceVersion":"8463" "creationTimestamp":"2019-02-28T12:49:53Z" "labels":map["jenkins.io/version":"0.0.5" "jenkins.io/chart-release":"jx-app-jenkins"]] "rules":[map["verbs":["get" "list" "watch" "patch" "create" "update" "delete"] "apiGroups":["extensions"] "resources":["ingresses"]] map["resources":["configmaps" "services"] "verbs":["get" "list" "watch" "patch" "update"] "apiGroups":[""]] map["verbs":["get" "list" "watch" "patch" "update"] "apiGroups":["extensions" "apps"] "resources":["deployments"]] map["verbs":["get" "list" "watch" "patch" "create" "update" "delete"] "apiGroups":["" "route.openshift.io"] "resources":["routes"]]]]}
for: "/tmp/helm-template-workdir-285219988/jx/output/env/charts/cleanup/templates/role.yaml": roles.rbac.authorization.k8s.io "cleanup" is forbidden: attempt to grant extra privileges: [{[patch] [extensions] [ingresses] [] []} {[update] [extensions] [ingresses] [] []} {[delete] [extensions] [ingresses] [] []} {[update] [] [configmaps] [] []} {[patch] [] [services] [] []} {[update] [] [services] [] []} {[patch] [extensions] [deployments] [] []} {[update] [extensions] [deployments] [] []} {[get] [apps] [deployments] [] []} {[list] [apps] [deployments] [] []} {[watch] [apps] [deployments] [] []} {[patch] [apps] [deployments] [] []} {[update] [apps] [deployments] [] []} {[get] [] [routes] [] []} {[list] [] [routes] [] []} {[watch] [] [routes] [] []} {[patch] [] [routes] [] []} {[create] [] [routes] [] []} {[update] [] [routes] [] []} {[delete] [] [routes] [] []} {[get] [route.openshift.io] [routes] [] []} {[list] [route.openshift.io] [routes] [] []} {[watch] [route.openshift.io] [routes] [] []} {[patch] [route.openshift.io] [routes] [] []} {[create] [route.openshift.io] [routes] [] []} {[update] [route.openshift.io] [routes] [] []} {[delete] [route.openshift.io] [routes] [] []}] user=&{system:serviceaccount:jx:tekton-bot 44d58eff-3b57-11e9-b378-42010a840126 [system:serviceaccounts system:serviceaccounts:jx system:authenticated] map[]} ownerrules=[{[create] [authorization.k8s.io] [selfsubjectaccessreviews selfsubjectrulesreviews] [] []} {[get] [] [] [] [/api /api/* /apis /apis/* /healthz /openapi /openapi/* /swagger-2.0.0.pb-v1 /swagger.json /swaggerapi /swaggerapi/* /version /version/]} {[list create get update] [apiextensions.k8s.io] [customresourcedefinitions] [] []} {[create get] [] [namespaces] [] []} {[get list watch] [extensions] [ingresses] [] []} {[get] [] [services] [] []} {[list get watch] [] [secrets services] [] []} {[list get watch patch] [] [serviceaccounts configmaps] [] []} {[create get delete] [] [pods services] [] []} {[create] [] [pods/exec] [] []} {[get create update] [jenkins.io] [pipelineactivities sourcerepositories] [] []} {[get list watch] [jenkins.io] [plugins] [] []} {[create update get list watch] [jenkins.io] [users] [] []} {[get create list watch patch] [jenkins.io] [releases] [] []} {[get list] [] [namespaces] [] []} {[get list watch create] [extensions] [ingresses deployments] [] []} {[get create update] [jenkins.io] [pipelineactivities] [] []} {[create list get update] [jenkins.io] [environments] [] []} {[get list] [jenkins.io] [extensions] [] []} {[get list watch] [vault.banzaicloud.com] [vaults] [] []} {[get patch] [rbac.authorization.k8s.io] [rolebindings roles] [] []}] ruleResolutionErrors=[]
Error from server (Forbidden): error when applying patch:
{"metadata":{"annotations":{"jenkins.io/chart":"env","kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rbac.authorization.k8s.io/v1\",\"kind\":\"RoleBinding\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"env\"},\"labels\":{\"jenkins.io/chart-release\":\"jx\",\"jenkins.io/version\":\"9\"},\"name\":\"cleanup\",\"namespace\":\"jx\"},\"roleRef\":{\"apiGroup\":\"rbac.authorization.k8s.io\",\"kind\":\"Role\",\"name\":\"cleanup\"},\"subjects\":[{\"kind\":\"ServiceAccount\",\"name\":\"cleanup\",\"namespace\":\"jx\"}]}\n"},"labels":{"jenkins.io/chart-release":"jx","jenkins.io/version":"9"}}}
to:
Resource: "rbac.authorization.k8s.io/v1, Resource=rolebindings", GroupVersionKind: "rbac.authorization.k8s.io/v1, Kind=RoleBinding"
Name: "cleanup", Namespace: "jx"
Object: &{map["kind":"RoleBinding" "apiVersion":"rbac.authorization.k8s.io/v1" "metadata":map["name":"cleanup" "namespace":"jx" "selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/jx/rolebindings/cleanup" "uid":"5846ab8b-3b57-11e9-b378-42010a840126" "resourceVersion":"8466" "creationTimestamp":"2019-02-28T12:49:54Z" "labels":map["jenkins.io/chart-release":"jx-app-jenkins" "jenkins.io/version":"0.0.5"] "annotations":map["jenkins.io/chart":"jx-app-jenkins" "kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rbac.authorization.k8s.io/v1\",\"kind\":\"RoleBinding\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"jx-app-jenkins\"},\"labels\":{\"jenkins.io/chart-release\":\"jx-app-jenkins\",\"jenkins.io/version\":\"0.0.5\"},\"name\":\"cleanup\",\"namespace\":\"jx\"},\"roleRef\":{\"apiGroup\":\"rbac.authorization.k8s.io\",\"kind\":\"Role\",\"name\":\"cleanup\"},\"subjects\":[{\"kind\":\"ServiceAccount\",\"name\":\"cleanup\",\"namespace\":\"jx\"}]}\n"]] "subjects":[map["kind":"ServiceAccount" "name":"cleanup" "namespace":"jx"]] "roleRef":map["apiGroup":"rbac.authorization.k8s.io" "kind":"Role" "name":"cleanup"]]}
for: "/tmp/helm-template-workdir-285219988/jx/output/env/charts/cleanup/templates/rolebinding.yaml": rolebindings.rbac.authorization.k8s.io "cleanup" is forbidden: attempt to grant extra privileges: [{[patch] [extensions] [ingresses] [] []} {[update] [extensions] [ingresses] [] []} {[delete] [extensions] [ingresses] [] []} {[update] [] [configmaps] [] []} {[patch] [] [services] [] []} {[update] [] [services] [] []} {[patch] [extensions] [deployments] [] []} {[update] [extensions] [deployments] [] []} {[get] [apps] [deployments] [] []} {[list] [apps] [deployments] [] []} {[watch] [apps] [deployments] [] []} {[patch] [apps] [deployments] [] []} {[update] [apps] [deployments] [] []} {[get] [] [routes] [] []} {[list] [] [routes] [] []} {[watch] [] [routes] [] []} {[patch] [] [routes] [] []} {[create] [] [routes] [] []} {[update] [] [routes] [] []} {[delete] [] [routes] [] []} {[get] [route.openshift.io] [routes] [] []} {[list] [route.openshift.io] [routes] [] []} {[watch] [route.openshift.io] [routes] [] []} {[patch] [route.openshift.io] [routes] [] []} {[create] [route.openshift.io] [routes] [] []} {[update] [route.openshift.io] [routes] [] []} {[delete] [route.openshift.io] [routes] [] []}] user=&{system:serviceaccount:jx:tekton-bot 44d58eff-3b57-11e9-b378-42010a840126 [system:serviceaccounts system:serviceaccounts:jx system:authenticated] map[]} ownerrules=[{[create] [authorization.k8s.io] [selfsubjectaccessreviews selfsubjectrulesreviews] [] []} {[get] [] [] [] [/api /api/* /apis /apis/* /healthz /openapi /openapi/* /swagger-2.0.0.pb-v1 /swagger.json /swaggerapi /swaggerapi/* /version /version/]} {[list create get update] [apiextensions.k8s.io] [customresourcedefinitions] [] []} {[create get] [] [namespaces] [] []} {[get list watch] [extensions] [ingresses] [] []} {[get] [] [services] [] []} {[list get watch] [] [secrets services] [] []} {[list get watch patch] [] [serviceaccounts configmaps] [] []} {[create get delete] [] [pods services] [] []} {[create] [] [pods/exec] [] []} {[get create update] [jenkins.io] [pipelineactivities sourcerepositories] [] []} {[get list watch] [jenkins.io] [plugins] [] []} {[create update get list watch] [jenkins.io] [users] [] []} {[get create list watch patch] [jenkins.io] [releases] [] []} {[get list] [] [namespaces] [] []} {[get list watch create] [extensions] [ingresses deployments] [] []} {[get create update] [jenkins.io] [pipelineactivities] [] []} {[create list get update] [jenkins.io] [environments] [] []} {[get list] [jenkins.io] [extensions] [] []} {[get list watch] [vault.banzaicloud.com] [vaults] [] []} {[get patch] [rbac.authorization.k8s.io] [rolebindings roles] [] []}] ruleResolutionErrors=[]
Error from server (Forbidden): error when applying patch:
{"metadata":{"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"Service\",\"metadata\":{\"annotations\":{\"fabric8.io/expose\":\"true\",\"fabric8.io/ingress.annotations\":\"kubernetes.io/ingress.class: nginx\",\"jenkins.io/chart\":\"env\"},\"labels\":{\"chart\":\"demo261-0.0.1\",\"jenkins.io/chart-release\":\"jx\",\"jenkins.io/version\":\"9\"},\"name\":\"demo261\",\"namespace\":\"jx\"},\"spec\":{\"ports\":[{\"name\":\"http\",\"port\":80,\"protocol\":\"TCP\",\"targetPort\":8080}],\"selector\":{\"app\":\"jx-demo261\"},\"type\":\"ClusterIP\"}}\n"},"labels":{"jenkins.io/version":"9"}}}
to:
Resource: "/v1, Resource=services", GroupVersionKind: "/v1, Kind=Service"
Name: "demo261", Namespace: "jx"
Object: &{map["kind":"Service" "apiVersion":"v1" "metadata":map["creationTimestamp":"2019-02-28T18:29:15Z" "labels":map["jenkins.io/version":"8" "chart":"demo261-0.0.1" "jenkins.io/chart-release":"jx"] "annotations":map["jenkins.io/chart":"env" "kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"Service\",\"metadata\":{\"annotations\":{\"fabric8.io/expose\":\"true\",\"fabric8.io/ingress.annotations\":\"kubernetes.io/ingress.class: nginx\",\"jenkins.io/chart\":\"env\"},\"labels\":{\"chart\":\"demo261-0.0.1\",\"jenkins.io/chart-release\":\"jx\",\"jenkins.io/version\":\"8\"},\"name\":\"demo261\",\"namespace\":\"jx\"},\"spec\":{\"ports\":[{\"name\":\"http\",\"port\":80,\"protocol\":\"TCP\",\"targetPort\":8080}],\"selector\":{\"app\":\"jx-demo261\"},\"type\":\"ClusterIP\"}}\n" "fabric8.io/expose":"true" "fabric8.io/ingress.annotations":"kubernetes.io/ingress.class: nginx"] "name":"demo261" "namespace":"jx" "selfLink":"/api/v1/namespaces/jx/services/demo261" "uid":"c08c5453-3b86-11e9-b378-42010a840126" "resourceVersion":"67499"] "spec":map["ports":[map["name":"http" "protocol":"TCP" "port":'P' "targetPort":'\u1f90']] "selector":map["app":"jx-demo261"] "clusterIP":"10.59.240.238" "type":"ClusterIP" "sessionAffinity":"None"] "status":map["loadBalancer":map[]]]}
for: "/tmp/helm-template-workdir-285219988/jx/output/env/charts/demo261/templates/service.yaml": services "demo261" is forbidden: User "system:serviceaccount:jx:tekton-bot" cannot patch services in the namespace "jx"
Error from server (Forbidden): error when applying patch:
{"metadata":{"annotations":{"jenkins.io/chart":"env","kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rbac.authorization.k8s.io/v1\",\"kind\":\"Role\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"env\"},\"labels\":{\"jenkins.io/chart-release\":\"jx\",\"jenkins.io/version\":\"9\"},\"name\":\"expose\",\"namespace\":\"jx\"},\"rules\":[{\"apiGroups\":[\"extensions\"],\"resources\":[\"ingresses\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"create\",\"update\",\"delete\"]},{\"apiGroups\":[\"\"],\"resources\":[\"configmaps\",\"services\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"update\"]},{\"apiGroups\":[\"extensions\",\"apps\"],\"resources\":[\"deployments\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"update\"]},{\"apiGroups\":[\"\",\"route.openshift.io\"],\"resources\":[\"routes\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"create\",\"update\",\"delete\"]}]}\n"},"labels":{"jenkins.io/chart-release":"jx","jenkins.io/version":"9"}}}
to:
Resource: "rbac.authorization.k8s.io/v1, Resource=roles", GroupVersionKind: "rbac.authorization.k8s.io/v1, Kind=Role"
Name: "expose", Namespace: "jx"
Object: &{map["kind":"Role" "apiVersion":"rbac.authorization.k8s.io/v1" "metadata":map["annotations":map["jenkins.io/chart":"jx-app-jenkins" "kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rbac.authorization.k8s.io/v1\",\"kind\":\"Role\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"jx-app-jenkins\"},\"labels\":{\"jenkins.io/chart-release\":\"jx-app-jenkins\",\"jenkins.io/version\":\"0.0.5\"},\"name\":\"expose\",\"namespace\":\"jx\"},\"rules\":[{\"apiGroups\":[\"extensions\"],\"resources\":[\"ingresses\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"create\",\"update\",\"delete\"]},{\"apiGroups\":[\"\"],\"resources\":[\"configmaps\",\"services\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"update\"]},{\"apiGroups\":[\"extensions\",\"apps\"],\"resources\":[\"deployments\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"update\"]},{\"apiGroups\":[\"\",\"route.openshift.io\"],\"resources\":[\"routes\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"create\",\"update\",\"delete\"]}]}\n"] "name":"expose" "namespace":"jx" "selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/jx/roles/expose" "uid":"5ba460d2-3b57-11e9-b378-42010a840126" "resourceVersion":"8468" "creationTimestamp":"2019-02-28T12:49:59Z" "labels":map["jenkins.io/chart-release":"jx-app-jenkins" "jenkins.io/version":"0.0.5"]] "rules":[map["verbs":["get" "list" "watch" "patch" "create" "update" "delete"] "apiGroups":["extensions"] "resources":["ingresses"]] map["verbs":["get" "list" "watch" "patch" "update"] "apiGroups":[""] "resources":["configmaps" "services"]] map["verbs":["get" "list" "watch" "patch" "update"] "apiGroups":["extensions" "apps"] "resources":["deployments"]] map["verbs":["get" "list" "watch" "patch" "create" "update" "delete"] "apiGroups":["" "route.openshift.io"] "resources":["routes"]]]]}
for: "/tmp/helm-template-workdir-285219988/jx/output/env/charts/expose/templates/role.yaml": roles.rbac.authorization.k8s.io "expose" is forbidden: attempt to grant extra privileges: [{[patch] [extensions] [ingresses] [] []} {[update] [extensions] [ingresses] [] []} {[delete] [extensions] [ingresses] [] []} {[update] [] [configmaps] [] []} {[patch] [] [services] [] []} {[update] [] [services] [] []} {[patch] [extensions] [deployments] [] []} {[update] [extensions] [deployments] [] []} {[get] [apps] [deployments] [] []} {[list] [apps] [deployments] [] []} {[watch] [apps] [deployments] [] []} {[patch] [apps] [deployments] [] []} {[update] [apps] [deployments] [] []} {[get] [] [routes] [] []} {[list] [] [routes] [] []} {[watch] [] [routes] [] []} {[patch] [] [routes] [] []} {[create] [] [routes] [] []} {[update] [] [routes] [] []} {[delete] [] [routes] [] []} {[get] [route.openshift.io] [routes] [] []} {[list] [route.openshift.io] [routes] [] []} {[watch] [route.openshift.io] [routes] [] []} {[patch] [route.openshift.io] [routes] [] []} {[create] [route.openshift.io] [routes] [] []} {[update] [route.openshift.io] [routes] [] []} {[delete] [route.openshift.io] [routes] [] []}] user=&{system:serviceaccount:jx:tekton-bot 44d58eff-3b57-11e9-b378-42010a840126 [system:serviceaccounts system:serviceaccounts:jx system:authenticated] map[]} ownerrules=[{[create] [authorization.k8s.io] [selfsubjectaccessreviews selfsubjectrulesreviews] [] []} {[get] [] [] [] [/api /api/* /apis /apis/* /healthz /openapi /openapi/* /swagger-2.0.0.pb-v1 /swagger.json /swaggerapi /swaggerapi/* /version /version/]} {[list create get update] [apiextensions.k8s.io] [customresourcedefinitions] [] []} {[create get] [] [namespaces] [] []} {[get list watch] [extensions] [ingresses] [] []} {[get] [] [services] [] []} {[list get watch] [] [secrets services] [] []} {[list get watch patch] [] [serviceaccounts configmaps] [] []} {[create get delete] [] [pods services] [] []} {[create] [] [pods/exec] [] []} {[get create update] [jenkins.io] [pipelineactivities sourcerepositories] [] []} {[get list watch] [jenkins.io] [plugins] [] []} {[create update get list watch] [jenkins.io] [users] [] []} {[get create list watch patch] [jenkins.io] [releases] [] []} {[get list] [] [namespaces] [] []} {[get list watch create] [extensions] [ingresses deployments] [] []} {[get create update] [jenkins.io] [pipelineactivities] [] []} {[create list get update] [jenkins.io] [environments] [] []} {[get list] [jenkins.io] [extensions] [] []} {[get list watch] [vault.banzaicloud.com] [vaults] [] []} {[get patch] [rbac.authorization.k8s.io] [rolebindings roles] [] []}] ruleResolutionErrors=[]
Error from server (Forbidden): error when applying patch:
{"metadata":{"annotations":{"jenkins.io/chart":"env","kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rbac.authorization.k8s.io/v1\",\"kind\":\"RoleBinding\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"env\"},\"labels\":{\"jenkins.io/chart-release\":\"jx\",\"jenkins.io/version\":\"9\"},\"name\":\"expose\",\"namespace\":\"jx\"},\"roleRef\":{\"apiGroup\":\"rbac.authorization.k8s.io\",\"kind\":\"Role\",\"name\":\"expose\"},\"subjects\":[{\"kind\":\"ServiceAccount\",\"name\":\"expose\",\"namespace\":\"jx\"}]}\n"},"labels":{"jenkins.io/chart-release":"jx","jenkins.io/version":"9"}}}
to:
Resource: "rbac.authorization.k8s.io/v1, Resource=rolebindings", GroupVersionKind: "rbac.authorization.k8s.io/v1, Kind=RoleBinding"
Name: "expose", Namespace: "jx"
Object: &{map["kind":"RoleBinding" "apiVersion":"rbac.authorization.k8s.io/v1" "metadata":map["creationTimestamp":"2019-02-28T12:49:59Z" "labels":map["jenkins.io/chart-release":"jx-app-jenkins" "jenkins.io/version":"0.0.5"] "annotations":map["jenkins.io/chart":"jx-app-jenkins" "kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rbac.authorization.k8s.io/v1\",\"kind\":\"RoleBinding\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"jx-app-jenkins\"},\"labels\":{\"jenkins.io/chart-release\":\"jx-app-jenkins\",\"jenkins.io/version\":\"0.0.5\"},\"name\":\"expose\",\"namespace\":\"jx\"},\"roleRef\":{\"apiGroup\":\"rbac.authorization.k8s.io\",\"kind\":\"Role\",\"name\":\"expose\"},\"subjects\":[{\"kind\":\"ServiceAccount\",\"name\":\"expose\",\"namespace\":\"jx\"}]}\n"] "name":"expose" "namespace":"jx" "selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/jx/rolebindings/expose" "uid":"5bb9a39b-3b57-11e9-b378-42010a840126" "resourceVersion":"8469"] "subjects":[map["kind":"ServiceAccount" "name":"expose" "namespace":"jx"]] "roleRef":map["name":"expose" "apiGroup":"rbac.authorization.k8s.io" "kind":"Role"]]}
for: "/tmp/helm-template-workdir-285219988/jx/output/env/charts/expose/templates/rolebinding.yaml": rolebindings.rbac.authorization.k8s.io "expose" is forbidden: attempt to grant extra privileges: [{[patch] [extensions] [ingresses] [] []} {[update] [extensions] [ingresses] [] []} {[delete] [extensions] [ingresses] [] []} {[update] [] [configmaps] [] []} {[patch] [] [services] [] []} {[update] [] [services] [] []} {[patch] [extensions] [deployments] [] []} {[update] [extensions] [deployments] [] []} {[get] [apps] [deployments] [] []} {[list] [apps] [deployments] [] []} {[watch] [apps] [deployments] [] []} {[patch] [apps] [deployments] [] []} {[update] [apps] [deployments] [] []} {[get] [] [routes] [] []} {[list] [] [routes] [] []} {[watch] [] [routes] [] []} {[patch] [] [routes] [] []} {[create] [] [routes] [] []} {[update] [] [routes] [] []} {[delete] [] [routes] [] []} {[get] [route.openshift.io] [routes] [] []} {[list] [route.openshift.io] [routes] [] []} {[watch] [route.openshift.io] [routes] [] []} {[patch] [route.openshift.io] [routes] [] []} {[create] [route.openshift.io] [routes] [] []} {[update] [route.openshift.io] [routes] [] []} {[delete] [route.openshift.io] [routes] [] []}] user=&{system:serviceaccount:jx:tekton-bot 44d58eff-3b57-11e9-b378-42010a840126 [system:serviceaccounts system:serviceaccounts:jx system:authenticated] map[]} ownerrules=[{[create] [authorization.k8s.io] [selfsubjectaccessreviews selfsubjectrulesreviews] [] []} {[get] [] [] [] [/api /api/* /apis /apis/* /healthz /openapi /openapi/* /swagger-2.0.0.pb-v1 /swagger.json /swaggerapi /swaggerapi/* /version /version/]} {[list create get update] [apiextensions.k8s.io] [customresourcedefinitions] [] []} {[create get] [] [namespaces] [] []} {[get list watch] [extensions] [ingresses] [] []} {[get] [] [services] [] []} {[list get watch] [] [secrets services] [] []} {[list get watch patch] [] [serviceaccounts configmaps] [] []} {[create get delete] [] [pods services] [] []} {[create] [] [pods/exec] [] []} {[get create update] [jenkins.io] [pipelineactivities sourcerepositories] [] []} {[get list watch] [jenkins.io] [plugins] [] []} {[create update get list watch] [jenkins.io] [users] [] []} {[get create list watch patch] [jenkins.io] [releases] [] []} {[get list] [] [namespaces] [] []} {[get list watch create] [extensions] [ingresses deployments] [] []} {[get create update] [jenkins.io] [pipelineactivities] [] []} {[create list get update] [jenkins.io] [environments] [] []} {[get list] [jenkins.io] [extensions] [] []} {[get list watch] [vault.banzaicloud.com] [vaults] [] []} {[get patch] [rbac.authorization.k8s.io] [rolebindings roles] [] []}] ruleResolutionErrors=[]'
{"component":"entrypoint","error":"wrapped process failed: exit status 1","level":"error","msg":"Error executing test process","time":"2019-02-28T18:32:23Z"}
