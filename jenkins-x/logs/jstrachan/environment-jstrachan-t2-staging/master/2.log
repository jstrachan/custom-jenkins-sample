Step: build-step-credential-initializer-fpzw4:

{"level":"warn","ts":1551377385.758739,"logger":"fallback-logger","caller":"logging/config.go:65","msg":"Fetch GitHub commit ID from kodata failed: \"ref: refs/heads/test\" is not a valid GitHub commit ID"}
{"level":"info","ts":1551377385.7598736,"logger":"fallback-logger","caller":"creds-init/main.go:40","msg":"Credentials initialized."}
Step: build-step-git-source-jstrachan-environment-jstrachan-t2-stagin:

{"level":"warn","ts":1551377386.4293237,"logger":"fallback-logger","caller":"logging/config.go:65","msg":"Fetch GitHub commit ID from kodata failed: \"ref: refs/heads/test\" is not a valid GitHub commit ID"}
{"level":"info","ts":1551377387.546812,"logger":"fallback-logger","caller":"git-init/main.go:90","msg":"Successfully cloned \"https://github.com/jstrachan/environment-jstrachan-t2-staging\" @ \"v0.0.2\" in path \"/workspace/source\""}
Step: build-step-place-tools:

Step: build-step-setup-jx-git-credentials:

Generated Git credentials file /home/jenkins/git/credentials
Step: build-step-build-helm-apply:

Modified file /workspace/source/env/Chart.yaml to set the chart to version 2
No $CHART_REPOSITORY defined so using the default value of: http://jenkins-x-chartmuseum:8080
Adding missing Helm repo: jenkins-x http://chartmuseum.jenkins-x.io
Successfully added Helm repository jenkins-x.
Adding missing Helm repo: releases http://jenkins-x-chartmuseum:8080
Successfully added Helm repository releases.
No --namespace option specified or $DEPLOY_NAMESPACE environment variable available so defaulting to using namespace jx
Applying helm chart at . as release name jx to namespace jx
Ignoring templates/.gitignore
Wrote chart values.yaml values.yaml generated from directory tree
Using values files: values.yaml
Applying generated chart . YAML via kubectl in dir: /tmp/helm-template-workdir-503514511/jx/output
Error from server (Forbidden): error when retrieving current configuration of:
Resource: "rbac.authorization.k8s.io/v1, Resource=roles", GroupVersionKind: "rbac.authorization.k8s.io/v1, Kind=Role"
Name: "cleanup", Namespace: "jx"
Object: &{map["apiVersion":"rbac.authorization.k8s.io/v1" "kind":"Role" "metadata":map["annotations":map["jenkins.io/chart":"env" "kubectl.kubernetes.io/last-applied-configuration":""] "labels":map["jenkins.io/chart-release":"jx" "jenkins.io/version":"2"] "name":"cleanup" "namespace":"jx"] "rules":[map["apiGroups":["extensions"] "resources":["ingresses"] "verbs":["get" "list" "watch" "patch" "create" "update" "delete"]] map["apiGroups":[""] "resources":["configmaps" "services"] "verbs":["get" "list" "watch" "patch" "update"]] map["verbs":["get" "list" "watch" "patch" "update"] "apiGroups":["extensions" "apps"] "resources":["deployments"]] map["verbs":["get" "list" "watch" "patch" "create" "update" "delete"] "apiGroups":["" "route.openshift.io"] "resources":["routes"]]]]}
from server for: "/tmp/helm-template-workdir-503514511/jx/output/env/charts/cleanup/templates/role.yaml": roles.rbac.authorization.k8s.io "cleanup" is forbidden: User "system:serviceaccount:jx:tekton-bot" cannot get roles.rbac.authorization.k8s.io in the namespace "jx"
Error from server (Forbidden): error when retrieving current configuration of:
Resource: "rbac.authorization.k8s.io/v1, Resource=rolebindings", GroupVersionKind: "rbac.authorization.k8s.io/v1, Kind=RoleBinding"
Name: "cleanup", Namespace: "jx"
Object: &{map["subjects":[map["name":"cleanup" "namespace":"jx" "kind":"ServiceAccount"]] "apiVersion":"rbac.authorization.k8s.io/v1" "kind":"RoleBinding" "metadata":map["annotations":map["jenkins.io/chart":"env" "kubectl.kubernetes.io/last-applied-configuration":""] "labels":map["jenkins.io/version":"2" "jenkins.io/chart-release":"jx"] "name":"cleanup" "namespace":"jx"] "roleRef":map["apiGroup":"rbac.authorization.k8s.io" "kind":"Role" "name":"cleanup"]]}
from server for: "/tmp/helm-template-workdir-503514511/jx/output/env/charts/cleanup/templates/rolebinding.yaml": rolebindings.rbac.authorization.k8s.io "cleanup" is forbidden: User "system:serviceaccount:jx:tekton-bot" cannot get rolebindings.rbac.authorization.k8s.io in the namespace "jx"
Error from server (Forbidden): error when applying patch:
{"metadata":{"annotations":{"jenkins.io/chart":"env","kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"ServiceAccount\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"env\"},\"labels\":{\"app\":\"cleanup\",\"chart\":\"cleanup-2.3.89\",\"heritage\":\"Tiller\",\"jenkins.io/chart-release\":\"jx\",\"jenkins.io/version\":\"2\",\"release\":\"jx\"},\"name\":\"cleanup\",\"namespace\":\"jx\"}}\n"},"labels":{"chart":"cleanup-2.3.89","jenkins.io/chart-release":"jx","jenkins.io/version":"2","release":"jx"}}}
to:
Resource: "/v1, Resource=serviceaccounts", GroupVersionKind: "/v1, Kind=ServiceAccount"
Name: "cleanup", Namespace: "jx"
Object: &{map["secrets":[map["name":"cleanup-token-nmcm5"]] "kind":"ServiceAccount" "apiVersion":"v1" "metadata":map["name":"cleanup" "namespace":"jx" "selfLink":"/api/v1/namespaces/jx/serviceaccounts/cleanup" "uid":"585df744-3b57-11e9-b378-42010a840126" "resourceVersion":"8467" "creationTimestamp":"2019-02-28T12:49:54Z" "labels":map["app":"cleanup" "chart":"cleanup-2.3.95" "heritage":"Tiller" "jenkins.io/chart-release":"jx-app-jenkins" "jenkins.io/version":"0.0.5" "release":"jx-app-jenkins"] "annotations":map["kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"ServiceAccount\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"jx-app-jenkins\"},\"labels\":{\"app\":\"cleanup\",\"chart\":\"cleanup-2.3.95\",\"heritage\":\"Tiller\",\"jenkins.io/chart-release\":\"jx-app-jenkins\",\"jenkins.io/version\":\"0.0.5\",\"release\":\"jx-app-jenkins\"},\"name\":\"cleanup\",\"namespace\":\"jx\"}}\n" "jenkins.io/chart":"jx-app-jenkins"]]]}
for: "/tmp/helm-template-workdir-503514511/jx/output/env/charts/cleanup/templates/serviceaccount.yaml": serviceaccounts "cleanup" is forbidden: User "system:serviceaccount:jx:tekton-bot" cannot patch serviceaccounts in the namespace "jx"
Error from server (Forbidden): error when retrieving current configuration of:
Resource: "extensions/v1beta1, Resource=deployments", GroupVersionKind: "extensions/v1beta1, Kind=Deployment"
Name: "jx-demo261", Namespace: "jx"
Object: &{map["apiVersion":"extensions/v1beta1" "kind":"Deployment" "metadata":map["annotations":map["kubectl.kubernetes.io/last-applied-configuration":"" "jenkins.io/chart":"env"] "labels":map["chart":"demo261-0.0.1" "draft":"draft-app" "jenkins.io/chart-release":"jx" "jenkins.io/version":"2"] "name":"jx-demo261" "namespace":"jx"] "spec":map["replicas":'\x01' "template":map["metadata":map["labels":map["app":"jx-demo261" "draft":"draft-app"]] "spec":map["containers":[map["image":"draft:0.0.1" "imagePullPolicy":"IfNotPresent" "livenessProbe":map["httpGet":map["path":"/actuator/health" "port":'\u1f90'] "initialDelaySeconds":'<' "periodSeconds":'\n' "successThreshold":'\x01' "timeoutSeconds":'\x01'] "name":"demo261" "ports":[map["containerPort":'\u1f90']] "readinessProbe":map["timeoutSeconds":'\x01' "httpGet":map["path":"/actuator/health" "port":'\u1f90'] "periodSeconds":'\n' "successThreshold":'\x01'] "resources":map["limits":map["cpu":"500m" "memory":"512Mi"] "requests":map["cpu":"400m" "memory":"512Mi"]]]] "terminationGracePeriodSeconds":'\n']]]]}
from server for: "/tmp/helm-template-workdir-503514511/jx/output/env/charts/demo261/templates/deployment.yaml": deployments.extensions "jx-demo261" is forbidden: User "system:serviceaccount:jx:tekton-bot" cannot get deployments.extensions in the namespace "jx"
Error from server (Forbidden): error when applying patch:
{"metadata":{"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"jenkins.io/v1\",\"kind\":\"Release\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"env\"},\"creationTimestamp\":\"2019-02-28T17:23:31Z\",\"deletionTimestamp\":null,\"labels\":{\"jenkins.io/chart-release\":\"jx\",\"jenkins.io/version\":\"2\"},\"name\":\"demo261-0.0.1\",\"namespace\":\"jx\"},\"spec\":{\"commits\":[{\"author\":{},\"branch\":\"master\",\"committer\":{},\"message\":\"release 0.0.1\\n\",\"sha\":\"457a5e15d94992060372f09ee3552592b2c9438f\"}],\"gitCloneUrl\":\"https://github.com/jstrachan/demo261.git\",\"gitHttpUrl\":\"https://github.com/jstrachan/demo261\",\"gitOwner\":\"jstrachan\",\"gitRepository\":\"demo261\",\"name\":\"demo261\",\"releaseNotesURL\":\"https://github.com/jstrachan/demo261/releases/tag/v0.0.1\",\"version\":\"v0.0.1\"},\"status\":{}}\n"},"creationTimestamp":"2019-02-28T17:23:31Z","labels":{"jenkins.io/version":"2"}}}
to:
Resource: "jenkins.io/v1, Resource=releases", GroupVersionKind: "jenkins.io/v1, Kind=Release"
Name: "demo261-0.0.1", Namespace: "jx"
Object: &{map["status":map[] "apiVersion":"jenkins.io/v1" "kind":"Release" "metadata":map["labels":map["jenkins.io/chart-release":"jx" "jenkins.io/version":"1"] "namespace":"jx" "selfLink":"/apis/jenkins.io/v1/namespaces/jx/releases/demo261-0.0.1" "uid":"275be177-3b83-11e9-b378-42010a840126" "annotations":map["jenkins.io/chart":"env" "kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"jenkins.io/v1\",\"kind\":\"Release\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"env\"},\"creationTimestamp\":\"2019-02-28T17:23:31Z\",\"deletionTimestamp\":null,\"labels\":{\"jenkins.io/chart-release\":\"jx\",\"jenkins.io/version\":\"1\"},\"name\":\"demo261-0.0.1\",\"namespace\":\"jx\"},\"spec\":{\"commits\":[{\"author\":{},\"branch\":\"master\",\"committer\":{},\"message\":\"release 0.0.1\\n\",\"sha\":\"457a5e15d94992060372f09ee3552592b2c9438f\"}],\"gitCloneUrl\":\"https://github.com/jstrachan/demo261.git\",\"gitHttpUrl\":\"https://github.com/jstrachan/demo261\",\"gitOwner\":\"jstrachan\",\"gitRepository\":\"demo261\",\"name\":\"demo261\",\"releaseNotesURL\":\"https://github.com/jstrachan/demo261/releases/tag/v0.0.1\",\"version\":\"v0.0.1\"},\"status\":{}}\n"] "creationTimestamp":"2019-02-28T18:03:29Z" "resourceVersion":"62265" "generation":'\x01' "name":"demo261-0.0.1"] "spec":map["gitCloneUrl":"https://github.com/jstrachan/demo261.git" "gitHttpUrl":"https://github.com/jstrachan/demo261" "gitOwner":"jstrachan" "gitRepository":"demo261" "name":"demo261" "releaseNotesURL":"https://github.com/jstrachan/demo261/releases/tag/v0.0.1" "version":"v0.0.1" "commits":[map["branch":"master" "committer":map[] "message":"release 0.0.1\n" "sha":"457a5e15d94992060372f09ee3552592b2c9438f" "author":map[]]]]]}
for: "/tmp/helm-template-workdir-503514511/jx/output/env/charts/demo261/templates/release.yaml": releases.jenkins.io "demo261-0.0.1" is forbidden: User "system:serviceaccount:jx:tekton-bot" cannot patch releases.jenkins.io in the namespace "jx"
Error from server (Forbidden): error when creating "/tmp/helm-template-workdir-503514511/jx/output/env/charts/demo261/templates/service.yaml": services is forbidden: User "system:serviceaccount:jx:tekton-bot" cannot create services in the namespace "jx"
Error from server (Forbidden): error when applying patch:
{"metadata":{"annotations":{"jenkins.io/chart":"env","kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"data\":{\"config.yml\":\"exposer: Ingress\\ndomain: 35.240.86.243.nip.io\\nhttp: true\\ntls-acme: false\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"env\"},\"labels\":{\"jenkins.io/chart-release\":\"jx\",\"jenkins.io/version\":\"2\"},\"name\":\"exposecontroller\",\"namespace\":\"jx\"}}\n"},"labels":{"jenkins.io/chart-release":"jx","jenkins.io/version":"2"}}}
to:
Resource: "/v1, Resource=configmaps", GroupVersionKind: "/v1, Kind=ConfigMap"
Name: "exposecontroller", Namespace: "jx"
Object: &{map["apiVersion":"v1" "metadata":map["uid":"5b8e2a02-3b57-11e9-b378-42010a840126" "resourceVersion":"1783" "creationTimestamp":"2019-02-28T12:49:59Z" "labels":map["jenkins.io/chart-release":"jenkins-x" "jenkins.io/version":"0.0.3480"] "annotations":map["jenkins.io/chart":"jenkins-x-platform" "kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"data\":{\"config.yml\":\"exposer: Ingress\\ndomain: 35.240.86.243.nip.io\\nhttp: true\\ntls-acme: false\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"jenkins-x-platform\"},\"labels\":{\"jenkins.io/chart-release\":\"jenkins-x\",\"jenkins.io/version\":\"0.0.3480\"},\"name\":\"exposecontroller\",\"namespace\":\"jx\"}}\n"] "name":"exposecontroller" "namespace":"jx" "selfLink":"/api/v1/namespaces/jx/configmaps/exposecontroller"] "data":map["config.yml":"exposer: Ingress\ndomain: 35.240.86.243.nip.io\nhttp: true\ntls-acme: false"] "kind":"ConfigMap"]}
for: "/tmp/helm-template-workdir-503514511/jx/output/env/charts/expose/templates/configmap.yaml": configmaps "exposecontroller" is forbidden: User "system:serviceaccount:jx:tekton-bot" cannot patch configmaps in the namespace "jx"
Error from server (Forbidden): error when retrieving current configuration of:
Resource: "rbac.authorization.k8s.io/v1, Resource=roles", GroupVersionKind: "rbac.authorization.k8s.io/v1, Kind=Role"
Name: "expose", Namespace: "jx"
Object: &{map["apiVersion":"rbac.authorization.k8s.io/v1" "kind":"Role" "metadata":map["namespace":"jx" "annotations":map["jenkins.io/chart":"env" "kubectl.kubernetes.io/last-applied-configuration":""] "labels":map["jenkins.io/chart-release":"jx" "jenkins.io/version":"2"] "name":"expose"] "rules":[map["apiGroups":["extensions"] "resources":["ingresses"] "verbs":["get" "list" "watch" "patch" "create" "update" "delete"]] map["apiGroups":[""] "resources":["configmaps" "services"] "verbs":["get" "list" "watch" "patch" "update"]] map["apiGroups":["extensions" "apps"] "resources":["deployments"] "verbs":["get" "list" "watch" "patch" "update"]] map["apiGroups":["" "route.openshift.io"] "resources":["routes"] "verbs":["get" "list" "watch" "patch" "create" "update" "delete"]]]]}
from server for: "/tmp/helm-template-workdir-503514511/jx/output/env/charts/expose/templates/role.yaml": roles.rbac.authorization.k8s.io "expose" is forbidden: User "system:serviceaccount:jx:tekton-bot" cannot get roles.rbac.authorization.k8s.io in the namespace "jx"
Error from server (Forbidden): error when retrieving current configuration of:
Resource: "rbac.authorization.k8s.io/v1, Resource=rolebindings", GroupVersionKind: "rbac.authorization.k8s.io/v1, Kind=RoleBinding"
Name: "expose", Namespace: "jx"
Object: &{map["kind":"RoleBinding" "metadata":map["annotations":map["jenkins.io/chart":"env" "kubectl.kubernetes.io/last-applied-configuration":""] "labels":map["jenkins.io/chart-release":"jx" "jenkins.io/version":"2"] "name":"expose" "namespace":"jx"] "roleRef":map["apiGroup":"rbac.authorization.k8s.io" "kind":"Role" "name":"expose"] "subjects":[map["kind":"ServiceAccount" "name":"expose" "namespace":"jx"]] "apiVersion":"rbac.authorization.k8s.io/v1"]}
from server for: "/tmp/helm-template-workdir-503514511/jx/output/env/charts/expose/templates/rolebinding.yaml": rolebindings.rbac.authorization.k8s.io "expose" is forbidden: User "system:serviceaccount:jx:tekton-bot" cannot get rolebindings.rbac.authorization.k8s.io in the namespace "jx"
Error from server (Forbidden): error when applying patch:
{"metadata":{"annotations":{"jenkins.io/chart":"env","kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"ServiceAccount\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"env\"},\"labels\":{\"app\":\"expose\",\"chart\":\"expose-2.3.89\",\"heritage\":\"Tiller\",\"jenkins.io/chart-release\":\"jx\",\"jenkins.io/version\":\"2\",\"release\":\"jx\"},\"name\":\"expose\",\"namespace\":\"jx\"}}\n"},"labels":{"chart":"expose-2.3.89","jenkins.io/chart-release":"jx","jenkins.io/version":"2","release":"jx"}}}
to:
Resource: "/v1, Resource=serviceaccounts", GroupVersionKind: "/v1, Kind=ServiceAccount"
Name: "expose", Namespace: "jx"
Object: &{map["apiVersion":"v1" "metadata":map["resourceVersion":"8470" "creationTimestamp":"2019-02-28T12:49:59Z" "labels":map["app":"expose" "chart":"expose-2.3.95" "heritage":"Tiller" "jenkins.io/chart-release":"jx-app-jenkins" "jenkins.io/version":"0.0.5" "release":"jx-app-jenkins"] "annotations":map["jenkins.io/chart":"jx-app-jenkins" "kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"ServiceAccount\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"jx-app-jenkins\"},\"labels\":{\"app\":\"expose\",\"chart\":\"expose-2.3.95\",\"heritage\":\"Tiller\",\"jenkins.io/chart-release\":\"jx-app-jenkins\",\"jenkins.io/version\":\"0.0.5\",\"release\":\"jx-app-jenkins\"},\"name\":\"expose\",\"namespace\":\"jx\"}}\n"] "name":"expose" "namespace":"jx" "selfLink":"/api/v1/namespaces/jx/serviceaccounts/expose" "uid":"5bcd2ac7-3b57-11e9-b378-42010a840126"] "secrets":[map["name":"expose-token-5h8rp"]] "kind":"ServiceAccount"]}
for: "/tmp/helm-template-workdir-503514511/jx/output/env/charts/expose/templates/serviceaccount.yaml": serviceaccounts "expose" is forbidden: User "system:serviceaccount:jx:tekton-bot" cannot patch serviceaccounts in the namespace "jx"
error: upgrading helm chart '.': failed to run 'kubectl apply --recursive -f /tmp/helm-template-workdir-503514511/jx/output -l jenkins.io/chart-release=jx --namespace jx --wait --validate=false' command in directory '', output: 'Error from server (Forbidden): error when retrieving current configuration of:
Resource: "rbac.authorization.k8s.io/v1, Resource=roles", GroupVersionKind: "rbac.authorization.k8s.io/v1, Kind=Role"
Name: "cleanup", Namespace: "jx"
Object: &{map["apiVersion":"rbac.authorization.k8s.io/v1" "kind":"Role" "metadata":map["annotations":map["jenkins.io/chart":"env" "kubectl.kubernetes.io/last-applied-configuration":""] "labels":map["jenkins.io/chart-release":"jx" "jenkins.io/version":"2"] "name":"cleanup" "namespace":"jx"] "rules":[map["apiGroups":["extensions"] "resources":["ingresses"] "verbs":["get" "list" "watch" "patch" "create" "update" "delete"]] map["apiGroups":[""] "resources":["configmaps" "services"] "verbs":["get" "list" "watch" "patch" "update"]] map["verbs":["get" "list" "watch" "patch" "update"] "apiGroups":["extensions" "apps"] "resources":["deployments"]] map["verbs":["get" "list" "watch" "patch" "create" "update" "delete"] "apiGroups":["" "route.openshift.io"] "resources":["routes"]]]]}
from server for: "/tmp/helm-template-workdir-503514511/jx/output/env/charts/cleanup/templates/role.yaml": roles.rbac.authorization.k8s.io "cleanup" is forbidden: User "system:serviceaccount:jx:tekton-bot" cannot get roles.rbac.authorization.k8s.io in the namespace "jx"
Error from server (Forbidden): error when retrieving current configuration of:
Resource: "rbac.authorization.k8s.io/v1, Resource=rolebindings", GroupVersionKind: "rbac.authorization.k8s.io/v1, Kind=RoleBinding"
Name: "cleanup", Namespace: "jx"
Object: &{map["subjects":[map["name":"cleanup" "namespace":"jx" "kind":"ServiceAccount"]] "apiVersion":"rbac.authorization.k8s.io/v1" "kind":"RoleBinding" "metadata":map["annotations":map["jenkins.io/chart":"env" "kubectl.kubernetes.io/last-applied-configuration":""] "labels":map["jenkins.io/version":"2" "jenkins.io/chart-release":"jx"] "name":"cleanup" "namespace":"jx"] "roleRef":map["apiGroup":"rbac.authorization.k8s.io" "kind":"Role" "name":"cleanup"]]}
from server for: "/tmp/helm-template-workdir-503514511/jx/output/env/charts/cleanup/templates/rolebinding.yaml": rolebindings.rbac.authorization.k8s.io "cleanup" is forbidden: User "system:serviceaccount:jx:tekton-bot" cannot get rolebindings.rbac.authorization.k8s.io in the namespace "jx"
Error from server (Forbidden): error when applying patch:
{"metadata":{"annotations":{"jenkins.io/chart":"env","kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"ServiceAccount\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"env\"},\"labels\":{\"app\":\"cleanup\",\"chart\":\"cleanup-2.3.89\",\"heritage\":\"Tiller\",\"jenkins.io/chart-release\":\"jx\",\"jenkins.io/version\":\"2\",\"release\":\"jx\"},\"name\":\"cleanup\",\"namespace\":\"jx\"}}\n"},"labels":{"chart":"cleanup-2.3.89","jenkins.io/chart-release":"jx","jenkins.io/version":"2","release":"jx"}}}
to:
Resource: "/v1, Resource=serviceaccounts", GroupVersionKind: "/v1, Kind=ServiceAccount"
Name: "cleanup", Namespace: "jx"
Object: &{map["secrets":[map["name":"cleanup-token-nmcm5"]] "kind":"ServiceAccount" "apiVersion":"v1" "metadata":map["name":"cleanup" "namespace":"jx" "selfLink":"/api/v1/namespaces/jx/serviceaccounts/cleanup" "uid":"585df744-3b57-11e9-b378-42010a840126" "resourceVersion":"8467" "creationTimestamp":"2019-02-28T12:49:54Z" "labels":map["app":"cleanup" "chart":"cleanup-2.3.95" "heritage":"Tiller" "jenkins.io/chart-release":"jx-app-jenkins" "jenkins.io/version":"0.0.5" "release":"jx-app-jenkins"] "annotations":map["kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"ServiceAccount\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"jx-app-jenkins\"},\"labels\":{\"app\":\"cleanup\",\"chart\":\"cleanup-2.3.95\",\"heritage\":\"Tiller\",\"jenkins.io/chart-release\":\"jx-app-jenkins\",\"jenkins.io/version\":\"0.0.5\",\"release\":\"jx-app-jenkins\"},\"name\":\"cleanup\",\"namespace\":\"jx\"}}\n" "jenkins.io/chart":"jx-app-jenkins"]]]}
for: "/tmp/helm-template-workdir-503514511/jx/output/env/charts/cleanup/templates/serviceaccount.yaml": serviceaccounts "cleanup" is forbidden: User "system:serviceaccount:jx:tekton-bot" cannot patch serviceaccounts in the namespace "jx"
Error from server (Forbidden): error when retrieving current configuration of:
Resource: "extensions/v1beta1, Resource=deployments", GroupVersionKind: "extensions/v1beta1, Kind=Deployment"
Name: "jx-demo261", Namespace: "jx"
Object: &{map["apiVersion":"extensions/v1beta1" "kind":"Deployment" "metadata":map["annotations":map["kubectl.kubernetes.io/last-applied-configuration":"" "jenkins.io/chart":"env"] "labels":map["chart":"demo261-0.0.1" "draft":"draft-app" "jenkins.io/chart-release":"jx" "jenkins.io/version":"2"] "name":"jx-demo261" "namespace":"jx"] "spec":map["replicas":'\x01' "template":map["metadata":map["labels":map["app":"jx-demo261" "draft":"draft-app"]] "spec":map["containers":[map["image":"draft:0.0.1" "imagePullPolicy":"IfNotPresent" "livenessProbe":map["httpGet":map["path":"/actuator/health" "port":'\u1f90'] "initialDelaySeconds":'<' "periodSeconds":'\n' "successThreshold":'\x01' "timeoutSeconds":'\x01'] "name":"demo261" "ports":[map["containerPort":'\u1f90']] "readinessProbe":map["timeoutSeconds":'\x01' "httpGet":map["path":"/actuator/health" "port":'\u1f90'] "periodSeconds":'\n' "successThreshold":'\x01'] "resources":map["limits":map["cpu":"500m" "memory":"512Mi"] "requests":map["cpu":"400m" "memory":"512Mi"]]]] "terminationGracePeriodSeconds":'\n']]]]}
from server for: "/tmp/helm-template-workdir-503514511/jx/output/env/charts/demo261/templates/deployment.yaml": deployments.extensions "jx-demo261" is forbidden: User "system:serviceaccount:jx:tekton-bot" cannot get deployments.extensions in the namespace "jx"
Error from server (Forbidden): error when applying patch:
{"metadata":{"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"jenkins.io/v1\",\"kind\":\"Release\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"env\"},\"creationTimestamp\":\"2019-02-28T17:23:31Z\",\"deletionTimestamp\":null,\"labels\":{\"jenkins.io/chart-release\":\"jx\",\"jenkins.io/version\":\"2\"},\"name\":\"demo261-0.0.1\",\"namespace\":\"jx\"},\"spec\":{\"commits\":[{\"author\":{},\"branch\":\"master\",\"committer\":{},\"message\":\"release 0.0.1\\n\",\"sha\":\"457a5e15d94992060372f09ee3552592b2c9438f\"}],\"gitCloneUrl\":\"https://github.com/jstrachan/demo261.git\",\"gitHttpUrl\":\"https://github.com/jstrachan/demo261\",\"gitOwner\":\"jstrachan\",\"gitRepository\":\"demo261\",\"name\":\"demo261\",\"releaseNotesURL\":\"https://github.com/jstrachan/demo261/releases/tag/v0.0.1\",\"version\":\"v0.0.1\"},\"status\":{}}\n"},"creationTimestamp":"2019-02-28T17:23:31Z","labels":{"jenkins.io/version":"2"}}}
to:
Resource: "jenkins.io/v1, Resource=releases", GroupVersionKind: "jenkins.io/v1, Kind=Release"
Name: "demo261-0.0.1", Namespace: "jx"
Object: &{map["status":map[] "apiVersion":"jenkins.io/v1" "kind":"Release" "metadata":map["labels":map["jenkins.io/chart-release":"jx" "jenkins.io/version":"1"] "namespace":"jx" "selfLink":"/apis/jenkins.io/v1/namespaces/jx/releases/demo261-0.0.1" "uid":"275be177-3b83-11e9-b378-42010a840126" "annotations":map["jenkins.io/chart":"env" "kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"jenkins.io/v1\",\"kind\":\"Release\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"env\"},\"creationTimestamp\":\"2019-02-28T17:23:31Z\",\"deletionTimestamp\":null,\"labels\":{\"jenkins.io/chart-release\":\"jx\",\"jenkins.io/version\":\"1\"},\"name\":\"demo261-0.0.1\",\"namespace\":\"jx\"},\"spec\":{\"commits\":[{\"author\":{},\"branch\":\"master\",\"committer\":{},\"message\":\"release 0.0.1\\n\",\"sha\":\"457a5e15d94992060372f09ee3552592b2c9438f\"}],\"gitCloneUrl\":\"https://github.com/jstrachan/demo261.git\",\"gitHttpUrl\":\"https://github.com/jstrachan/demo261\",\"gitOwner\":\"jstrachan\",\"gitRepository\":\"demo261\",\"name\":\"demo261\",\"releaseNotesURL\":\"https://github.com/jstrachan/demo261/releases/tag/v0.0.1\",\"version\":\"v0.0.1\"},\"status\":{}}\n"] "creationTimestamp":"2019-02-28T18:03:29Z" "resourceVersion":"62265" "generation":'\x01' "name":"demo261-0.0.1"] "spec":map["gitCloneUrl":"https://github.com/jstrachan/demo261.git" "gitHttpUrl":"https://github.com/jstrachan/demo261" "gitOwner":"jstrachan" "gitRepository":"demo261" "name":"demo261" "releaseNotesURL":"https://github.com/jstrachan/demo261/releases/tag/v0.0.1" "version":"v0.0.1" "commits":[map["branch":"master" "committer":map[] "message":"release 0.0.1\n" "sha":"457a5e15d94992060372f09ee3552592b2c9438f" "author":map[]]]]]}
for: "/tmp/helm-template-workdir-503514511/jx/output/env/charts/demo261/templates/release.yaml": releases.jenkins.io "demo261-0.0.1" is forbidden: User "system:serviceaccount:jx:tekton-bot" cannot patch releases.jenkins.io in the namespace "jx"
Error from server (Forbidden): error when creating "/tmp/helm-template-workdir-503514511/jx/output/env/charts/demo261/templates/service.yaml": services is forbidden: User "system:serviceaccount:jx:tekton-bot" cannot create services in the namespace "jx"
Error from server (Forbidden): error when applying patch:
{"metadata":{"annotations":{"jenkins.io/chart":"env","kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"data\":{\"config.yml\":\"exposer: Ingress\\ndomain: 35.240.86.243.nip.io\\nhttp: true\\ntls-acme: false\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"env\"},\"labels\":{\"jenkins.io/chart-release\":\"jx\",\"jenkins.io/version\":\"2\"},\"name\":\"exposecontroller\",\"namespace\":\"jx\"}}\n"},"labels":{"jenkins.io/chart-release":"jx","jenkins.io/version":"2"}}}
to:
Resource: "/v1, Resource=configmaps", GroupVersionKind: "/v1, Kind=ConfigMap"
Name: "exposecontroller", Namespace: "jx"
Object: &{map["apiVersion":"v1" "metadata":map["uid":"5b8e2a02-3b57-11e9-b378-42010a840126" "resourceVersion":"1783" "creationTimestamp":"2019-02-28T12:49:59Z" "labels":map["jenkins.io/chart-release":"jenkins-x" "jenkins.io/version":"0.0.3480"] "annotations":map["jenkins.io/chart":"jenkins-x-platform" "kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"data\":{\"config.yml\":\"exposer: Ingress\\ndomain: 35.240.86.243.nip.io\\nhttp: true\\ntls-acme: false\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"jenkins-x-platform\"},\"labels\":{\"jenkins.io/chart-release\":\"jenkins-x\",\"jenkins.io/version\":\"0.0.3480\"},\"name\":\"exposecontroller\",\"namespace\":\"jx\"}}\n"] "name":"exposecontroller" "namespace":"jx" "selfLink":"/api/v1/namespaces/jx/configmaps/exposecontroller"] "data":map["config.yml":"exposer: Ingress\ndomain: 35.240.86.243.nip.io\nhttp: true\ntls-acme: false"] "kind":"ConfigMap"]}
for: "/tmp/helm-template-workdir-503514511/jx/output/env/charts/expose/templates/configmap.yaml": configmaps "exposecontroller" is forbidden: User "system:serviceaccount:jx:tekton-bot" cannot patch configmaps in the namespace "jx"
Error from server (Forbidden): error when retrieving current configuration of:
Resource: "rbac.authorization.k8s.io/v1, Resource=roles", GroupVersionKind: "rbac.authorization.k8s.io/v1, Kind=Role"
Name: "expose", Namespace: "jx"
Object: &{map["apiVersion":"rbac.authorization.k8s.io/v1" "kind":"Role" "metadata":map["namespace":"jx" "annotations":map["jenkins.io/chart":"env" "kubectl.kubernetes.io/last-applied-configuration":""] "labels":map["jenkins.io/chart-release":"jx" "jenkins.io/version":"2"] "name":"expose"] "rules":[map["apiGroups":["extensions"] "resources":["ingresses"] "verbs":["get" "list" "watch" "patch" "create" "update" "delete"]] map["apiGroups":[""] "resources":["configmaps" "services"] "verbs":["get" "list" "watch" "patch" "update"]] map["apiGroups":["extensions" "apps"] "resources":["deployments"] "verbs":["get" "list" "watch" "patch" "update"]] map["apiGroups":["" "route.openshift.io"] "resources":["routes"] "verbs":["get" "list" "watch" "patch" "create" "update" "delete"]]]]}
from server for: "/tmp/helm-template-workdir-503514511/jx/output/env/charts/expose/templates/role.yaml": roles.rbac.authorization.k8s.io "expose" is forbidden: User "system:serviceaccount:jx:tekton-bot" cannot get roles.rbac.authorization.k8s.io in the namespace "jx"
Error from server (Forbidden): error when retrieving current configuration of:
Resource: "rbac.authorization.k8s.io/v1, Resource=rolebindings", GroupVersionKind: "rbac.authorization.k8s.io/v1, Kind=RoleBinding"
Name: "expose", Namespace: "jx"
Object: &{map["kind":"RoleBinding" "metadata":map["annotations":map["jenkins.io/chart":"env" "kubectl.kubernetes.io/last-applied-configuration":""] "labels":map["jenkins.io/chart-release":"jx" "jenkins.io/version":"2"] "name":"expose" "namespace":"jx"] "roleRef":map["apiGroup":"rbac.authorization.k8s.io" "kind":"Role" "name":"expose"] "subjects":[map["kind":"ServiceAccount" "name":"expose" "namespace":"jx"]] "apiVersion":"rbac.authorization.k8s.io/v1"]}
from server for: "/tmp/helm-template-workdir-503514511/jx/output/env/charts/expose/templates/rolebinding.yaml": rolebindings.rbac.authorization.k8s.io "expose" is forbidden: User "system:serviceaccount:jx:tekton-bot" cannot get rolebindings.rbac.authorization.k8s.io in the namespace "jx"
Error from server (Forbidden): error when applying patch:
{"metadata":{"annotations":{"jenkins.io/chart":"env","kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"ServiceAccount\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"env\"},\"labels\":{\"app\":\"expose\",\"chart\":\"expose-2.3.89\",\"heritage\":\"Tiller\",\"jenkins.io/chart-release\":\"jx\",\"jenkins.io/version\":\"2\",\"release\":\"jx\"},\"name\":\"expose\",\"namespace\":\"jx\"}}\n"},"labels":{"chart":"expose-2.3.89","jenkins.io/chart-release":"jx","jenkins.io/version":"2","release":"jx"}}}
to:
Resource: "/v1, Resource=serviceaccounts", GroupVersionKind: "/v1, Kind=ServiceAccount"
Name: "expose", Namespace: "jx"
Object: &{map["apiVersion":"v1" "metadata":map["resourceVersion":"8470" "creationTimestamp":"2019-02-28T12:49:59Z" "labels":map["app":"expose" "chart":"expose-2.3.95" "heritage":"Tiller" "jenkins.io/chart-release":"jx-app-jenkins" "jenkins.io/version":"0.0.5" "release":"jx-app-jenkins"] "annotations":map["jenkins.io/chart":"jx-app-jenkins" "kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"ServiceAccount\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"jx-app-jenkins\"},\"labels\":{\"app\":\"expose\",\"chart\":\"expose-2.3.95\",\"heritage\":\"Tiller\",\"jenkins.io/chart-release\":\"jx-app-jenkins\",\"jenkins.io/version\":\"0.0.5\",\"release\":\"jx-app-jenkins\"},\"name\":\"expose\",\"namespace\":\"jx\"}}\n"] "name":"expose" "namespace":"jx" "selfLink":"/api/v1/namespaces/jx/serviceaccounts/expose" "uid":"5bcd2ac7-3b57-11e9-b378-42010a840126"] "secrets":[map["name":"expose-token-5h8rp"]] "kind":"ServiceAccount"]}
for: "/tmp/helm-template-workdir-503514511/jx/output/env/charts/expose/templates/serviceaccount.yaml": serviceaccounts "expose" is forbidden: User "system:serviceaccount:jx:tekton-bot" cannot patch serviceaccounts in the namespace "jx"'
{"component":"entrypoint","error":"wrapped process failed: exit status 1","level":"error","msg":"Error executing test process","time":"2019-02-28T18:10:03Z"}
